<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chat Application</title>
    <link
      rel="icon"
      type="image/x-icon"
      href="https://cdn.glitch.global/05a0f658-73c9-4927-9816-926caba90f4c/IMG_0843.jpeg?v=1729152770176"
    />
    <link rel="stylesheet" href="style.css" />
    <!-- Include Material Symbols -->
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/icon?family=Material+Symbols+Outlined"
    />
    <style>
      #leftPanel {
        display: none;
        position: absolute; /* or relative if contained in a specific element */
        top: 85px; /* Adjust based on desired alignment */
        left: 20px; /* Adjust to align with your layout */
        max-width: 410px;
        min-width: 200px;
        width: 15%; /* Set appropriate width */
        height: 90%; /* Set appropriate height */
        background-color: rgba(
          0,
          0,
          0,
          0.2
        ); /* Semi-transparent dark background */
        border-radius: 8px;
        padding: 10px;
        color: white;
        font-size: 14px;
        z-index: 10000;
      }

      .settings-container {
        max-width: 400px;
        width: 100%;
        margin: 0 auto;
        background-color: #2e2e2e; /* Dark Mode */
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      }
      .input-group {
        margin-bottom: 30px;
      }
      .input-group select {
        width: 100%;
        padding: 10px;
        background-color: #333;
        border: 1px solid #4d4d4d;
        border-radius: 5px;
        color: #fff;
      }
      .submit-btn {
        width: 100%;
        padding: 10px;
        background-color: #00b300;
        color: #fff;
        border: none;
        border-radius: 5px;
        cursor: pointer;
      }
      .submit-btn:hover {
        background-color: #009900;
      }
      /* Light Mode Styles */
      .light-mode {
        background-color: #f0f0f0;
        color: #000;
      }
      .light-mode .settings-container {
        background-color: #ffffff;
        color: #000;
      }
      #themesel {
        font-weight: bolder;
        text-size: 2em;
      }
    </style>
  </head>
  <body>
    <div id="tooltip" class="tooltip"></div>
    <!-- Navbar Section -->
    <nav>
      <ul>
        <p id="clock" data-tooltip="Current Time"></p>
        <li class="icon-container">
          <a href="profile.html" class="icon" data-tooltip="Profile">
            <span class="material-symbols-outlined">person</span>
          </a>
          <a href="#" class="settings icon" data-tooltip="Settings">
            <span class="material-symbols-outlined">settings</span>
          </a>
          <a
            href="https://games-hub.glitch.me/"
            class="icon"
            data-tooltip="Games"
          >
            <span class="material-symbols-outlined">sports_esports</span>
          </a>
          <a
            href="admin.html"
            id="adminLink"
            class="icon adminLink"
            data-tooltip="Admin"
          >
            <span class="material-symbols-outlined">manage_accounts</span>
          </a>
          <a href="weather.html" class="icon" data-tooltip="Weather">
            <span class="material-symbols-outlined">rainy</span>
          </a>
          <a href="about.html" class="icon" data-tooltip="About">
            <span class="material-symbols-outlined">info</span>
          </a>
          <a href="login.html" class="icon" data-tooltip="Logout">
            <span class="material-symbols-outlined">logout</span>
          </a>
        </li>
        <p id="count" data-tooltip="Time till 16:00">XXh XXm XXs</p>
      </ul>
    </nav>
    <div id="mobile-nav">
      <button id="menuButton" class="menu-button" onclick="toggleMobileMenu()">
        MENU
      </button>
    </div>

    <div class="mobile-menu">
      <a href="profile.html" class="icon icon-mobile" data-tooltip="Profile">
        <span class="material-symbols-outlined">person</span>
        <div style="margin: 10px">Profile</div>
      </a>
      <a href="#" class="icon icon-mobile settings" data-tooltip="Settings">
        <span class="material-symbols-outlined">settings</span>
        <div style="margin: 10px">Settings</div>
      </a>
      <a
        href="https://games-hub.glitch.me/"
        class="icon icon-mobile"
        data-tooltip="Games"
      >
        <span class="material-symbols-outlined">sports_esports</span>
        <div style="margin: 10px">Games</div>
      </a>
      <a
        href="admin.html"
        id="adminLinkMobile"
        class="icon adminLink icon-mobile"
        data-tooltip="Admin"
      >
        <span class="material-symbols-outlined">manage_accounts</span>
        <div style="margin: 10px">Admin</div>
      </a>
      <a href="weather.html" class="icon icon-mobile" data-tooltip="Weather">
        <span class="material-symbols-outlined">rainy</span>
        <div style="margin: 10px">Weather</div>
      </a>
      <a href="about.html" class="icon icon-mobile" data-tooltip="About">
        <span class="material-symbols-outlined">info</span>
        <div style="margin: 10px">About</div>
      </a>
      <a href="login.html" class="icon icon-mobile" data-tooltip="Logout">
        <span class="material-symbols-outlined">logout</span>
        <div style="margin: 10px">Logout</div>
      </a>
    </div>

    <div id="statuslobby" data-tooltip="Rejoin?"></div>
    <div id="status" data-tooltip="Online Users"></div>

    <div id="leftPanel">
      <div class="settings-container">
        <h2>Settings</h2>
        <div class="input-group">
          <label id="themesel">Theme:</label>
          <select id="theme">
            <option value="DarkMode">Dark Mode</option>
            <option value="LightMode">Light Mode</option>
          </select>
        </div>
        <div class="input-group">
          <input type="checkbox" id="notifications" />
          <label for="notifications">Enable Notifications</label>
        </div>
        <button type="button" class="submit-btn" id="saveSettingsBtn">
          Save Settings
        </button>
      </div>
    </div>

    <!-- Chat Area -->
    <div id="main-container">
      <div class="toggle-switch">
        <input type="checkbox" id="alwaysOnCheckbox" class="toggle-checkbox" />
        <label for="alwaysOnCheckbox" class="toggle-label"></label>
      </div>
      <div id="statusText"></div>

      <div id="chat-container">
        <input id="burger" type="checkbox" style="display: none" />

        <label for="burger">
          <div id="span-container" data-tooltip="Lobbys">
            <span></span>
            <span></span>
            <span></span>
          </div>
        </label>

        <div id="lobby-selection" class="lobby-selection">
          <ul id="lobby-list">
            <li>
              <a
                href="#"
                class="lobby-option"
                data-lobby="lobby 1"
                data-tooltip="Lobby 1"
                >Lobby 1</a
              >
            </li>
            <li>
              <a
                href="#"
                class="lobby-option"
                data-lobby="lobby 2"
                data-tooltip="Lobby 2"
                >Lobby 2</a
              >
            </li>
            <li>
              <a
                href="#"
                class="lobby-option"
                data-lobby="lobby 3"
                data-tooltip="Lobby 3"
                >Lobby 3</a
              >
            </li>
            <li>
              <a
                href="#"
                class="lobby-option"
                data-lobby="Programming"
                data-tooltip="Programming"
                >Programming</a
              >
            </li>
          </ul>
        </div>
        <div id="chat"></div>
        <div id="messageMenu" class="message-menu">
          <div class="menu-option" id="pinMessage">Pin Message</div>
          <div class="menu-option" id="deleteMessage">Delete Message</div>
          <!-- Add other options here -->
        </div>
        <div class="selected-message-container"></div>
      </div>
    </div>

    <div id="MessageSend">
      <input
        type="file"
        id="imageInput"
        accept="image/*"
        style="display: none"
      />
      <button type="button" id="sendImage">
        <span class="material-symbols-outlined"> attach_file </span>
      </button>

      <input id="message" type="text" placeholder="Enter message" />
      <button type="button" id="send">
        <span class="material-symbols-outlined"> send </span>
      </button>
    </div>

    <script>
      if (!sessionStorage.getItem("loggedIn")) {
        window.location.href = "/login.html";
      }

      window.onload = () => {
        if (!sessionStorage.getItem("loggedIn")) {
          sessionStorage.setItem("loggedIn", "true");
        }

        // Check for admin privileges
        const adminLink = document.getElementById("adminLink");
        const adminLinkMobile = document.getElementById("adminLinkMobile");
        const role = sessionStorage.getItem("role"); // Get the role from sessionStorage
        if (role === "banned") {
          window.location.href = "/banned.html";
        }
        if (role !== "admin") {
          adminLink.style.display = "none"; // Hide the admin link if role is not admin
          adminLinkMobile.style.display = "none"; // Hide the admin link if role is not admin
        }
      };
      // Theme Management
      const theme = sessionStorage.getItem("theme"); // Default to DarkMode
      applyTheme(theme);

      function applyTheme(theme) {
        if (theme === "LightMode") {
          document.body.classList.add("light-mode");
          sessionStorage.setItem("theme", "LightMode"); // Save theme to sessionStorage
        } else {
          document.body.classList.remove("light-mode");
          sessionStorage.setItem("theme", "DarkMode"); // Save theme to sessionStorage
        }
      }
      const tooltip = document.getElementById("tooltip");
      const icons = document.querySelectorAll(".icon");

      // Show tooltip and position it based on mouse movement for icons
      icons.forEach((icon) => {
        icon.addEventListener("mouseenter", (event) => {
          const iconText = event.target.getAttribute("data-tooltip");
          tooltip.textContent = iconText; // Set the tooltip text
          tooltip.style.display = "block"; // Show the tooltip
        });

        icon.addEventListener("mousemove", (event) => {
          tooltip.style.left = `${event.pageX + 10}px`; // Position tooltip to the right of the cursor
          tooltip.style.top = `${event.pageY + 10}px`; // Position tooltip below the cursor
        });

        icon.addEventListener("mouseleave", () => {
          tooltip.style.display = "none"; // Hide the tooltip when not hovering
        });
      });

      // Show tooltip for the statuslobby
      const statusLobby = document.getElementById("statuslobby");

      statusLobby.addEventListener("mouseenter", (event) => {
        const iconText = event.target.getAttribute("data-tooltip");
        tooltip.textContent = iconText; // Set the tooltip text
        tooltip.style.display = "block"; // Show the tooltip
      });

      statusLobby.addEventListener("mousemove", (event) => {
        tooltip.style.left = `${event.pageX + 10}px`; // Position tooltip to the right of the cursor
        tooltip.style.top = `${event.pageY + 10}px`; // Position tooltip below the cursor
      });

      statusLobby.addEventListener("mouseleave", () => {
        tooltip.style.display = "none"; // Hide the tooltip when not hovering
      });

      const status = document.getElementById("status");
      status.addEventListener("mouseenter", (event) => {
        const iconText = event.target.getAttribute("data-tooltip");
        tooltip.textContent = iconText; // Set the tooltip text
        tooltip.style.display = "block"; // Show the tooltip
      });

      status.addEventListener("mousemove", (event) => {
        tooltip.style.left = `${event.pageX + 10}px`; // Position tooltip to the right of the cursor
        tooltip.style.top = `${event.pageY + 10}px`; // Position tooltip below the cursor
      });

      status.addEventListener("mouseleave", () => {
        tooltip.style.display = "none"; // Hide the tooltip when not hovering
      });

      const clock = document.getElementById("clock");
      clock.addEventListener("mouseenter", (event) => {
        const iconText = event.target.getAttribute("data-tooltip");
        tooltip.textContent = iconText; // Set the tooltip text
        tooltip.style.display = "block"; // Show the tooltip
      });

      clock.addEventListener("mousemove", (event) => {
        tooltip.style.left = `${event.pageX + 10}px`; // Position tooltip to the right of the cursor
        tooltip.style.top = `${event.pageY + 10}px`; // Position tooltip below the cursor
      });

      clock.addEventListener("mouseleave", () => {
        tooltip.style.display = "none"; // Hide the tooltip when not hovering
      });

      const count = document.getElementById("count");
      count.addEventListener("mouseenter", (event) => {
        const iconText = event.target.getAttribute("data-tooltip");
        tooltip.textContent = iconText; // Set the tooltip text
        tooltip.style.display = "block"; // Show the tooltip
      });

      count.addEventListener("mousemove", (event) => {
        tooltip.style.left = `${event.pageX + 10}px`; // Position tooltip to the right of the cursor
        tooltip.style.top = `${event.pageY + 10}px`; // Position tooltip below the cursor
      });

      count.addEventListener("mouseleave", () => {
        tooltip.style.display = "none"; // Hide the tooltip when not hovering
      });

      const lobbyOption = document.querySelectorAll(".lobby-option");

      // Show tooltip and position it based on mouse movement for icons
      lobbyOption.forEach((lobbyOption) => {
        lobbyOption.addEventListener("mouseenter", (event) => {
          const iconText = event.target.getAttribute("data-tooltip");
          tooltip.textContent = iconText; // Set the tooltip text
          tooltip.style.display = "block"; // Show the tooltip
        });

        lobbyOption.addEventListener("mousemove", (event) => {
          tooltip.style.left = `${event.pageX + 10}px`; // Position tooltip to the right of the cursor
          tooltip.style.top = `${event.pageY + 10}px`; // Position tooltip below the cursor
        });

        lobbyOption.addEventListener("mouseleave", () => {
          tooltip.style.display = "none"; // Hide the tooltip when not hovering
        });
      });

      const Lobbys = document.getElementById("span-container");
      Lobbys.addEventListener("mouseenter", (event) => {
        const iconText = event.target.getAttribute("data-tooltip");
        tooltip.textContent = iconText; // Set the tooltip text
        tooltip.style.display = "block"; // Show the tooltip
      });

      Lobbys.addEventListener("mousemove", (event) => {
        tooltip.style.left = `${event.pageX + 10}px`; // Position tooltip to the right of the cursor
        tooltip.style.top = `${event.pageY + 10}px`; // Position tooltip below the cursor
      });

      Lobbys.addEventListener("mouseleave", () => {
        tooltip.style.display = "none"; // Hide the tooltip when not hovering
      });
    </script>
    <script>
      function updateClock() {
        const now = new Date();
        const hours = String(now.getHours()).padStart(2, "0");
        const minutes = String(now.getMinutes()).padStart(2, "0");
        const seconds = String(now.getSeconds()).padStart(2, "0");

        const timeString = `${hours}:${minutes}:${seconds}`;

        document.getElementById("clock").textContent = timeString;
      }

      // Update the clock every second
      setInterval(updateClock, 1000);

      // Initial call to set the clock right away
      updateClock();

      function startCountdown() {
        const countElement = document.getElementById("count");

        // Update the countdown every 1 second
        setInterval(function () {
          // Get current time
          const now = new Date();

          // Set the target time to today at 16:00
          let targetTime = new Date();
          targetTime.setHours(16, 0, 0, 0); // Set hours to 16:00:00:000

          // If it's past 16:00, set the target time to tomorrow's 16:00
          if (now >= targetTime) {
            targetTime.setDate(targetTime.getDate() + 1);
          }

          // Calculate the difference in milliseconds
          const timeDifference = targetTime - now;

          // Convert milliseconds to hours, minutes, and seconds
          const hours = String(
            Math.floor(
              (timeDifference % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)
            )
          ).padStart(2, "0");
          const minutes = String(
            Math.floor((timeDifference % (1000 * 60 * 60)) / (1000 * 60))
          ).padStart(2, "0");
          const seconds = String(
            Math.floor((timeDifference % (1000 * 60)) / 1000)
          ).padStart(2, "0");

          // Display the result in the element with id="count"
          countElement.innerHTML = `${hours}h ${minutes}m ${seconds}s`;
        }, 1000); // Refresh every 1 second
      }

      // Start the countdown when the page loads
      startCountdown();
    </script>
    <script>
      const MessageSend = document.querySelector(".MessageSend");
      function toggleMobileMenu() {
        const mobileMenu = document.querySelector(".mobile-menu");
        const body = document.querySelector("body");

        if (mobileMenu.classList.contains("show")) {
          // Hide the menu with slide-up animation
          mobileMenu.classList.remove("show");
          mobileMenu.classList.add("hide");
          body.style.overflow = "auto"; // Restore scroll
        } else {
          // Show the menu with slide-down animation
          mobileMenu.classList.remove("hide");
          mobileMenu.classList.add("show");
          body.style.overflow = "hidden"; // Disable scroll
        }
      }
    </script>
    <script src="script.js" defer></script>
    <script>
      const settings = document.querySelector(".settings");

      settings.addEventListener("click", () => {
        leftPanel.style.display = "block";
      });

      const themeSelect = document.getElementById("theme");
      const notificationsCheckbox = document.getElementById("notifications");
      const saveSettingsBtn = document.getElementById("saveSettingsBtn");

      // Load saved settings
      document.addEventListener("DOMContentLoaded", () => {
        const theme = localStorage.getItem("theme") || "Dark-Mode";
        const notifications = localStorage.getItem("notifications") === "true";

        themeSelect.value = theme;
        notificationsCheckbox.checked = notifications;

        // Apply the saved theme
        applyTheme(theme);
      });

      saveSettingsBtn.addEventListener("click", () => {
        const selectedTheme = themeSelect.value;
        const notificationsEnabled = notificationsCheckbox.checked;

        // Save settings
        localStorage.setItem("theme", selectedTheme);
        localStorage.setItem("notifications", notificationsEnabled);

        // Apply the selected theme
        applyTheme(selectedTheme);

        // Demonstrate notifications
        if (notificationsEnabled) {
          alert("Notifications are enabled!");
        } else {
        }

        alert("Settings saved successfully!");

        leftPanel.style.display = "none";
      });

      function applyTheme(theme) {
        if (theme === "LightMode") {
          document.body.classList.add("light-mode");
        } else {
          document.body.classList.remove("light-mode");
        }
      }
    </script>
  </body>
</html>
